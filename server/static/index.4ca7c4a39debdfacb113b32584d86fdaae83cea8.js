!function(){"use strict";function e(){i(),r(),s()}window.WebComponents=window.WebComponents||{};var t=[];if("attachShadow"in Element.prototype&&"getRootNode"in Element.prototype||t.push("sd"),window.customElements||t.push("ce"),"content"in document.createElement("template")&&window.Promise&&Array.from&&document.createDocumentFragment().cloneNode()instanceof DocumentFragment||(t=["lite"]),t.length){var n=document.createElement("script"),o="/static/webcomponentsjs/webcomponents-"+t.join("-")+".js";n.src=o,document.head.appendChild(n)}else window.WebComponents.ready=!0,document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:!0}));var i=function(){const e=document.createElement("template");e.innerHTML=`\n<style>\n::slotted(*) {\n  display: none;\n}\n::slotted([active]) {\n  display: block;\n}\n</style>\n<slot>\n  <hn-list route="top" path="news"></hn-list>\n  <hn-list route="new" path="newest"></hn-list>\n  <hn-list route="ask" path="ask"></hn-list>\n  <hn-list route="show" path="show"></hn-list>\n  <hn-list route="jobs" path="jobs"></hn-list>\n  <hn-item route="item"></hn-item>\n  <hn-about route="about"></hn-about>\n</slot>\n`,window.ShadyCSS&&ShadyCSS.prepareTemplate(e,"hn-app");class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}).appendChild(document.importNode(e.content,!0))}connectedCallback(){const e=this.shadowRoot.querySelector("slot").assignedNodes({flatten:!0}).filter(e=>e.nodeType==Node.ELEMENT_NODE&&e.hasAttribute("route"));this.active=null,this.rendered=!1,this.routes=e.reduce((e,t)=>{t.hasAttribute("active")&&(this.active=t,this.rendered=!0);let n=t.getAttribute("route");e[n]=t;return e},{}),document.body.addEventListener("click",e=>this._handleClick(e)),window.addEventListener("popstate",()=>this._handleUrlChange()),window.ShadyCSS&&window.ShadyCSS.styleElement(this),this.rendered||this._handleUrlChange()}_handleClick(e){if(0===e.button&&!e.metaKey&&!e.ctrlKey){let t=window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.host,n=e.composedPath().filter(e=>"a"===e.localName)[0];n&&0===n.href.indexOf(t)&&(e.preventDefault(),window.history.pushState({},"",n.href),this._handleUrlChange())}}_handleUrlChange(){let e=window.location.pathname.split("/")[1]||"news",t=this.routes[e]||this.routes.unknown;this.active&&this.active!==t&&this.active.removeAttribute("active"),this.active=t,this.active.setAttribute("active","")}_computePath(e){return window.decodeURIComponent(window.location.pathname).slice(1).split("/")}}customElements.define("hn-app",t)},s=function(){const e=document.createElement("template");e.innerHTML=`\n<custom-style>\n<style>\n  :host {\n    display: block;\n  }\n</style>\n</custom-style>\n<slot>\n  <h1>About</h1>\n  <p>This is an example of a PWA built using pure WebComponents.</p>\n  <p>It is not intended to be any kind of definitive blueprint for building applications,\n     just an example to demonstrate that it is possible to build a modern, fast, Progressive\n     Web App without depending on a framework - because WebComponents are like having a\n     framework that is built in to the browser.</p>\n  <p><a href="https://github.com/CaptainCodeman/hn-webcomponents">Github Repo</a>.</p>\n</slot>`,window.ShadyCSS&&ShadyCSS.prepareTemplate(e,"hn-about");class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}).appendChild(document.importNode(e.content,!0))}connectedCallback(){window.ShadyCSS&&window.ShadyCSS.styleElement(this)}}customElements.define("hn-about",t)},r=function(){const e="https://node-hnapi.herokuapp.com",t=document.createElement("template");t.innerHTML=`\n<custom-style>\n<style>\n  :host {\n    display: block;\n  }\n  .nav {\n    padding: 1em;\n    margin: 0 auto;\n    text-align: center;\n  }\n  .prev, .next {\n    color: #666;\n    text-decoration: none;\n    margin: 0 1em;\n  }\n  [disabled] {\n    visibility: hidden;\n  }\n  #prerender {\n    table-layout: fixed;\n    border-collapse: collapse;\n  }\n  ol {\n    counter-reset: Item 1;\n    margin: 0;\n    padding: 0;\n    list-style-type: none;\n    border-top: 1px solid #ccc;\n    border-bottom: 1px solid #ccc;\n  }\n  li {\n    clear: both;\n    margin: 1.5rem 0.5rem;\n    font-size: 0.75em;\n  }\n  li:before {\n    content: counter(Item, decimal);\n    counter-increment: Item;\n    font-size: 1.5rem;\n    min-width: 1.5em;\n    margin-right: 0.75rem;\n    float: left;\n    text-align: right;\n    color: #666;\n  }\n  h3 {\n    font-size: 1rem;\n    font-weight: normal;\n    margin: 0.5rem 0;\n  }\n  .title {\n    color: #000;\n    text-decoration: none;\n  }\n  .item {\n    margin-left: 3rem;\n  }\n  .user, .comments {\n    color: #333\n  }\n</style>\n</custom-style>\n<slot>\n  <div class="nav"><a class="prev" disabled>&lt; prev</a> <span class="page"></span> / <span class="count"></span> <a class="next">next &gt;</a></div>\n  <ol></ol>\n  <div class="nav"><a class="prev" disabled>&lt; prev</a> <span class="page"></span> / <span class="count"></span> <a class="next">next &gt;</a></div>\n</slot>`;const n=document.createElement("template");n.innerHTML=`\n<li>\n  <div class="item">\n    <h3><a class="title"></a> <small></small></h3>\n    <b></b> points by <a class="user"></a> <i></i> | <a class="comments"></a>\n  </div>\n</li>`;const o=n.content.querySelector(".title"),i=n.content.querySelector("small"),s=n.content.querySelector(".user"),r=n.content.querySelector("b"),a=n.content.querySelector("i"),c=n.content.querySelector(".comments");window.ShadyCSS&&ShadyCSS.prepareTemplate(t,"hn-list");class h extends HTMLElement{static get observedAttributes(){return["active","path","route","page"]}constructor(){super(),this.attachShadow({mode:"open"}).appendChild(document.importNode(t.content,!0))}connectedCallback(){let e=this.hasAttribute("active")?this:this.shadowRoot;this._ol=e.querySelector("ol"),this._prev=e.querySelectorAll(".prev"),this._next=e.querySelectorAll(".next"),this._pageNo=e.querySelectorAll(".page"),this._count=e.querySelectorAll(".count"),window.ShadyCSS&&window.ShadyCSS.styleElement(this)}attributeChangedCallback(e,t,n){switch(e){case"active":null!==n&&this._load();break;case"page":this._page=parseInt(n);break;default:t!==n&&(this[e]=n)}}get path(){return this._path}set path(e){this._path=e}get route(){return this._route}set route(e){this._route=e}_load(){let t=window.location.pathname.split("/"),n=t.length<3?1:parseInt(t[2]);if(n!==this._page){this._page=n,this._loading=!0;let t=`${e}/${this._path}?page=${this._page}`;this._fetch(t).then(e=>requestAnimationFrame(()=>this._render(e)))}}_fetch(e){return document.body.scrollTop=0,fetch(e).then(e=>e.json().then(e=>{this._pendingFetch=null;this._loading=!1;return e}),e=>{navigator.onLine||(this._view="offline");this._loading=!1;return Promise.reject(e)})}_render(e){for(;this._ol.firstChild;)this._ol.removeChild(this._ol.firstChild);this._ol.style.counterReset="Item "+30*(this._page-1);for(var t=0;t<e.length;t++){let h=e[t];o.innerText=h.title,i.innerText="("+h.domain+")",s.innerText=h.user,s.href="/user/"+h.user,r.innerText=h.points,a.innerText=h.time_ago,c.innerText=h.comments_count+" comments";let d=n.content.cloneNode(!0);this._ol.appendChild(d)}this._prev.forEach(e=>{e.href="/"+this.route+"/"+(this._page-1);1==this._page?e.setAttribute("disabled",""):e.removeAttribute("disabled")}),this._next.forEach(e=>{e.href="/"+this.route+"/"+(this._page+1);this._page>=3?e.setAttribute("disabled",""):e.removeAttribute("disabled")}),this._pageNo.forEach(e=>e.innerText=this._page),this._count.forEach(e=>e.innerText=3)}}customElements.define("hn-list",h)};(window.requestIdleCallback||window.requestAnimationFrame||function(e){e()})(()=>{window.WebComponents&&window.WebComponents.ready?e():window.addEventListener("WebComponentsReady",e)})}();
